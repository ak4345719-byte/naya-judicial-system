{% extends "base.html" %}

{% block title %}Dashboard | Naya Judicial System{% endblock %}

{% block head %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="space-y-8 animate-fade-in opacity-0" id="mainContent">


  <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
    <div>
      <h1 class="text-3xl font-bold text-gray-900 dark:text-white tracking-tight">Overview</h1>
      <p class="text-gray-500 dark:text-gray-400 mt-1">Updates for <span id="currentDate"
          class="font-medium text-gray-700 dark:text-gray-300">Today</span></p>
    </div>

    <div class="flex items-center gap-3">
      <button onclick="window.location.href='/case-registration'"
        class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-xl text-sm font-semibold shadow-lg shadow-indigo-500/20 hover:shadow-indigo-500/30 hover:-translate-y-0.5 transition-all flex items-center gap-2">
        <span class="iconify" data-icon="lucide:plus" data-width="18"></span>
        New Case
      </button>
    </div>
  </div>


  <div class="flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide">
    <button id="tab-all"
      class="filter-pill active px-4 py-1.5 rounded-full text-sm font-medium bg-indigo-600 text-white shadow-md transition-all">All
      Activity</button>
    <button id="tab-urgent"
      class="filter-pill px-4 py-1.5 rounded-full text-sm font-medium bg-white dark:bg-white/5 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 hover:border-indigo-500 hover:text-indigo-500 transition-all">Urgent
      Attention</button>
    <button id="tab-pending"
      class="filter-pill px-4 py-1.5 rounded-full text-sm font-medium bg-white dark:bg-white/5 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 hover:border-indigo-500 hover:text-indigo-500 transition-all">Pending
      Judgment</button>
    <button id="tab-calendar"
      class="filter-pill px-4 py-1.5 rounded-full text-sm font-medium bg-white dark:bg-white/5 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 hover:border-indigo-500 hover:text-indigo-500 transition-all">My
      Calendars</button>
  </div>

  <!-- Dynamic Tab Content Panel -->
  <div id="tabContent" class="hidden glass-card rounded-[2rem] p-8 premium-shadow animate-fade-in">
    <!-- Dynamic content will be injected here -->
  </div>


  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">

    <div
      class="glass-card p-6 rounded-[2.5rem] premium-shadow hover:-translate-y-1.5 transition-all duration-500 group relative overflow-hidden">
      <div
        class="skeleton-loader absolute inset-0 bg-gray-100 dark:bg-gray-800 animate-pulse z-10 transition-opacity duration-500">
      </div>
      <div class="flex justify-between items-start mb-5">
        <div class="p-4 bg-indigo-500 text-white rounded-2xl shadow-glow group-hover:scale-110 transition-transform">
          <span class="iconify" data-icon="lucide:folder-open" data-width="24"></span>
        </div>
        <span
          class="flex items-center text-[10px] font-black tracking-widest text-emerald-500 bg-emerald-500/10 px-2.5 py-1 rounded-full uppercase">
          Live <span class="iconify ml-1" data-icon="lucide:trending-up"></span>
        </span>
      </div>
      <p class="text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest">Total Active Cases
      </p>
      <h3 class="text-4xl font-black text-gray-900 dark:text-white mt-1.5 font-sans" id="stat-total">--</h3>
    </div>


    <div
      class="glass-card p-6 rounded-[2.5rem] premium-shadow hover:-translate-y-1.5 transition-all duration-500 group relative overflow-hidden">
      <div
        class="skeleton-loader absolute inset-0 bg-gray-100 dark:bg-gray-800 animate-pulse z-10 transition-opacity duration-500">
      </div>
      <div class="flex justify-between items-start mb-5">
        <div
          class="p-4 bg-amber-500 text-white rounded-2xl shadow-lg shadow-amber-500/20 group-hover:scale-110 transition-transform">
          <span class="iconify" data-icon="lucide:clock" data-width="24"></span>
        </div>
        <span
          class="flex items-center text-[10px] font-black tracking-widest text-rose-500 bg-rose-500/10 px-2.5 py-1 rounded-full uppercase">
          Priority
        </span>
      </div>
      <p class="text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest">Pending Hearings</p>
      <h3 class="text-4xl font-black text-gray-900 dark:text-white mt-1.5 font-sans" id="stat-pending">--</h3>
    </div>


    <div
      class="glass-card p-6 rounded-[2.5rem] premium-shadow hover:-translate-y-1.5 transition-all duration-500 group relative overflow-hidden">
      <div
        class="skeleton-loader absolute inset-0 bg-gray-100 dark:bg-gray-800 animate-pulse z-10 transition-opacity duration-500">
      </div>
      <div class="flex justify-between items-start mb-5">
        <div class="p-4 bg-violet-600 text-white rounded-2xl shadow-glow group-hover:scale-110 transition-transform">
          <span class="iconify" data-icon="lucide:calendar-check" data-width="24"></span>
        </div>
      </div>
      <p class="text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest">Listed Today</p>
      <h3 class="text-4xl font-black text-gray-900 dark:text-white mt-1.5 font-sans" id="stat-today">--</h3>
    </div>


    <div
      class="glass-card p-6 rounded-[2.5rem] premium-shadow hover:-translate-y-1.5 transition-all duration-500 group relative overflow-hidden">
      <div
        class="skeleton-loader absolute inset-0 bg-gray-100 dark:bg-gray-800 animate-pulse z-10 transition-opacity duration-500">
      </div>
      <div class="flex justify-between items-start mb-5">
        <div
          class="p-4 bg-emerald-500 text-white rounded-2xl shadow-lg shadow-emerald-500/20 group-hover:scale-110 transition-transform">
          <span class="iconify" data-icon="lucide:check-circle" data-width="24"></span>
        </div>
      </div>
      <p class="text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest">Clearance Rate</p>
      <h3 class="text-4xl font-black text-gray-900 dark:text-white mt-1.5 font-sans" id="stat-closed">--</h3>
    </div>
  </div>


  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">


    <div onclick="window.location.href='/smart-vault'"
      class="glass-card p-6 rounded-[2rem] premium-shadow cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all group">
      <div class="flex items-center gap-4 mb-4">
        <div class="p-4 bg-indigo-500 text-white rounded-2xl shadow-glow group-hover:scale-110 transition-transform">
          <span class="iconify" data-icon="lucide:lock" data-width="24"></span>
        </div>
        <div>
          <h3 class="font-black text-gray-900 dark:text-white">Smart Vault</h3>
          <p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest">Secure Evidence Storage</p>
        </div>
      </div>
      <p class="text-xs text-gray-500 dark:text-gray-400 mb-4 line-clamp-2 leading-relaxed">High-density encryption.
        AI-enhanced historical matching and Vision scanning.</p>
      <div class="flex items-center text-[10px] font-black uppercase tracking-widest text-indigo-500">
        Access Vault <span class="iconify ml-2 group-hover:translate-x-1 transition-transform"
          data-icon="lucide:arrow-right"></span>
      </div>
    </div>


    <div onclick="window.location.href='/drafting'"
      class="glass-card p-6 rounded-[2rem] premium-shadow cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all group">
      <div class="flex items-center gap-4 mb-4">
        <div class="p-4 bg-violet-600 text-white rounded-2xl shadow-glow group-hover:scale-110 transition-transform">
          <span class="iconify" data-icon="lucide:feather" data-width="24"></span>
        </div>
        <div>
          <h3 class="font-black text-gray-900 dark:text-white">Drafting Assist</h3>
          <p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest">AI Judgment Writer</p>
        </div>
      </div>
      <p class="text-xs text-gray-500 dark:text-gray-400 mb-4 line-clamp-2 leading-relaxed">Precedent-based drafting.
        Automatic statute cross-referencing.</p>
      <div class="flex items-center text-[10px] font-black uppercase tracking-widest text-violet-500">
        Start Drafting <span class="iconify ml-2 group-hover:translate-x-1 transition-transform"
          data-icon="lucide:arrow-right"></span>
      </div>
    </div>


    <div onclick="window.location.href='/virtual-hearing'"
      class="glass-card p-6 rounded-[2rem] premium-shadow cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all group">
      <div class="flex items-center gap-4 mb-4">
        <div
          class="p-4 bg-rose-500 text-white rounded-2xl shadow-lg shadow-rose-500/20 group-hover:scale-110 transition-transform">
          <span class="iconify" data-icon="lucide:video" data-width="24"></span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-center">
            <h3 class="font-black text-gray-900 dark:text-white">Virtual Court</h3>
            <span class="flex h-2 w-2 relative">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span>
            </span>
          </div>
          <p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest">Live Hearing Room</p>
        </div>
      </div>
      <p class="text-xs text-gray-500 dark:text-gray-400 mb-4 line-clamp-2 leading-relaxed">Secure video. Live
        Speech-to-Text transcription. AI Legal Intelligence.</p>
      <div class="flex items-center text-[10px] font-black uppercase tracking-widest text-rose-500">
        Join Session <span class="iconify ml-2 group-hover:translate-x-1 transition-transform"
          data-icon="lucide:arrow-right"></span>
      </div>
    </div>

  </div>


  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">


    <div class="lg:col-span-2 glass-card rounded-[2rem] premium-shadow p-6">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-black text-gray-900 dark:text-white">Judicial <span
            class="text-indigo-500">Efficiency</span></h3>
        <button
          class="text-[10px] font-black uppercase tracking-widest text-indigo-500 hover:text-indigo-700 transition">Download
          Analytics Report</button>
      </div>
      <div class="h-80 w-full relative">
        <canvas id="efficiencyChart"></canvas>
      </div>
    </div>


    <div class="space-y-6">


      <div
        class="bg-gradient-to-br from-indigo-600 to-violet-600 rounded-2xl p-6 text-white shadow-xl shadow-indigo-500/20 relative overflow-hidden">
        <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-3xl -mr-10 -mt-10"></div>

        <div class="relative z-10">
          <span class="bg-white/20 backdrop-blur-sm px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider">Up
            Next</span>
          <h4 class="text-2xl font-bold mt-3 mb-1">State vs. Rajesh</h4>
          <p class="text-indigo-100 text-sm mb-6 flex items-center gap-2">
            <span class="iconify" data-icon="lucide:clock" data-width="14"></span> 11:30 AM &bull; Courtroom 4
          </p>
          <button
            class="w-full py-3 bg-white text-indigo-600 font-bold rounded-xl hover:bg-indigo-50 transition-colors flex items-center justify-center gap-2">
            Open Case File
            <span class="iconify" data-icon="lucide:arrow-right" data-width="16"></span>
          </button>
        </div>
      </div>


      <div class="glass-card rounded-[2rem] p-6 premium-shadow">
        <h3
          class="text-sm font-bold text-gray-900 dark:text-white uppercase tracking-wider mb-4 flex items-center gap-2">
          <span class="iconify text-rose-500" data-icon="lucide:alert-circle" data-width="16"></span>
          Urgent Attention
        </h3>
        <div id="urgent-list" class="space-y-3">

          <div class="h-10 bg-gray-100 dark:bg-gray-800 rounded-lg w-full animate-pulse"></div>
          <div class="h-10 bg-gray-100 dark:bg-gray-800 rounded-lg w-full animate-pulse"></div>
        </div>
      </div>
    </div>


    <div class="glass-card rounded-[2rem] p-6 premium-shadow">
      <h3
        class="text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-4 flex items-center gap-2">
        <span class="iconify text-emerald-500" data-icon="lucide:gavel" data-width="16"></span>
        Active Judicial Officers
      </h3>
      <div id="judges-list" class="space-y-3">
        <div class="h-10 bg-gray-100 dark:bg-gray-800 rounded-lg w-full animate-pulse"></div>
      </div>
    </div>

  </div>
</div>

</div>


<style>
  .animate-fade-in {
    animation: fadeIn 0.6s ease-out forwards;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .skeleton-loader {
    transition: opacity 0.5s ease-out;
  }

  .skeleton-loader.fade-out {
    opacity: 0;
    pointer-events: none;
  }
</style>

{% endblock %}

{% block scripts %}
<script>

  const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
  document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', dateOptions);


  const pills = document.querySelectorAll('.filter-pill');
  const tabContent = document.getElementById('tabContent');

  const tabData = {
    'urgent': `
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-2xl font-black text-rose-500">Critical Alerts <span class="text-gray-400 font-normal text-sm ml-2">Priority Intelligence</span></h3>
        <span class="px-3 py-1 bg-rose-500/10 text-rose-500 text-[10px] font-black rounded-full animate-pulse border border-rose-500/20">SYSTEM HIGH-RISK</span>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="p-6 bg-rose-50/50 dark:bg-rose-500/5 border border-rose-100 dark:border-rose-900/20 rounded-3xl relative overflow-hidden group">
          <div class="flex justify-between items-start mb-4">
            <span class="px-2 py-1 bg-rose-500 text-white text-[8px] font-black rounded uppercase">OVERDUE BAIL</span>
            <span class="text-xs font-mono text-gray-400">#2024-0012</span>
          </div>
          <h4 class="font-bold text-gray-900 dark:text-white mb-2">State of Gujarat vs. Mahesh P.</h4>
          <p class="text-xs text-gray-500 leading-relaxed mb-4">Bail application period expired 2 hours ago. Automatic notification sent to Superintendent of Police.</p>
          <button class="w-full py-2 bg-rose-600 text-white text-[10px] font-black rounded-xl hover:bg-rose-700 transition">RESOLVE IMMEDIATELY</button>
        </div>
        <div class="p-6 bg-amber-50/50 dark:bg-amber-500/5 border border-amber-100 dark:border-amber-900/20 rounded-3xl group">
          <div class="flex justify-between items-start mb-4">
            <span class="px-2 py-1 bg-amber-500 text-white text-[8px] font-black rounded uppercase">INTEGRITY ALERT</span>
            <span class="text-xs font-mono text-gray-400">#2024-0015</span>
          </div>
          <h4 class="font-bold text-gray-900 dark:text-white mb-2">Commercial Suit: X Corp vs Y Inc</h4>
          <p class="text-xs text-gray-500 leading-relaxed mb-4">Immutable ledger mismatch detected in Exhibit-4. Verification required before next hearing.</p>
          <button class="w-full py-2 bg-amber-500 text-white text-[10px] font-black rounded-xl hover:bg-amber-600 transition">VERIFY LEDGER</button>
        </div>
      </div>
    `,
    'pending': `
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-2xl font-black text-violet-500">Reserved Judgments <span class="text-gray-400 font-normal text-sm ml-2">AI Drafting Pipeline</span></h3>
      </div>
      <div class="space-y-4">
        <div class="glass-card p-6 border border-violet-100 dark:border-violet-500/20 rounded-3xl flex items-center justify-between">
          <div class="flex items-center gap-6">
            <div class="w-16 h-16 bg-violet-500/10 rounded-2xl flex items-center justify-center text-violet-500">
              <span class="iconify" data-icon="lucide:feather" data-width="32"></span>
            </div>
            <div>
              <h4 class="font-bold text-gray-900 dark:text-white">Civil Appeal: Builders Ltd vs State</h4>
              <p class="text-xs text-gray-500 mt-1">Judgment Reserved on Dec 14, 2025</p>
              <div class="mt-4 flex items-center gap-3">
                <div class="h-1.5 w-48 bg-gray-100 dark:bg-white/10 rounded-full overflow-hidden">
                  <div class="h-full bg-violet-600 w-[92%]"></div>
                </div>
                <span class="text-[10px] font-bold text-violet-600">92% AI DRAFT READY</span>
              </div>
            </div>
          </div>
          <button class="px-6 py-3 bg-violet-600 text-white text-xs font-black rounded-2xl shadow-glow hover:scale-105 transition">REVIEW DRAFT</button>
        </div>
      </div>
    `,
    'calendar': `
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-2xl font-black text-indigo-500">Judicial Timeline <span class="text-gray-400 font-normal text-sm ml-2">Today's Schedule</span></h3>
      </div>
      <div class="relative pl-8 border-l-2 border-dashed border-indigo-100 dark:border-indigo-500/20 space-y-8">
        <div class="relative">
          <div class="absolute -left-[2.55rem] top-1 w-4 h-4 rounded-full bg-indigo-500 ring-4 ring-white dark:ring-gray-900"></div>
          <div class="flex items-center justify-between bg-white dark:bg-white/5 p-4 rounded-2xl border border-indigo-50 shadow-sm">
            <div>
              <span class="text-[10px] font-black text-indigo-500 uppercase">10:30 AM &bull; Courtroom 4</span>
              <h5 class="font-bold text-gray-900 dark:text-white text-sm">Case #2024-112: State vs. Rajesh (Final Disposal)</h5>
            </div>
            <button onclick="window.location.href='/virtual-hearing'" class="px-4 py-2 bg-rose-500 text-white text-[10px] font-black rounded-lg shadow-lg shadow-rose-500/20">GO TO COURT</button>
          </div>
        </div>
        <div class="relative opacity-60">
          <div class="absolute -left-[2.55rem] top-1 w-4 h-4 rounded-full bg-gray-300 ring-4 ring-white dark:ring-gray-900"></div>
          <div class="flex items-center justify-between bg-white dark:bg-white/5 p-4 rounded-2xl border border-gray-100">
            <div>
              <span class="text-[10px] font-bold text-gray-400 uppercase">02:15 PM &bull; Chambers</span>
              <h5 class="font-bold text-gray-500 text-sm">Meeting with Justice Sharma (Bench Constitution)</h5>
            </div>
          </div>
        </div>
      </div>
    `
  };

  pills.forEach(pill => {
    pill.addEventListener('click', () => {
      pills.forEach(p => {
        p.classList.remove('bg-indigo-600', 'text-white', 'shadow-md', 'active');
        p.classList.add('bg-white', 'dark:bg-white/5', 'text-gray-600', 'dark:text-gray-400', 'border');
      });

      pill.classList.remove('bg-white', 'dark:bg-white/5', 'text-gray-600', 'dark:text-gray-400', 'border');
      pill.classList.add('bg-indigo-600', 'text-white', 'shadow-md', 'active');

      const id = pill.id.replace('tab-', '');
      if (id === 'all') {
        tabContent.classList.add('hidden');
      } else {
        tabContent.classList.remove('hidden');
        tabContent.innerHTML = tabData[id] || '<div class="text-center text-gray-400">Coming Soon...</div>';
      }

      showToast(`Viewing: ${pill.innerText}`, 'info');
    });
  });


  async function fetchStats() {
    try {
      const token = localStorage.getItem("token");
      const res = await fetch('/api/dashboard/stats', { headers: { 'Authorization': 'Bearer ' + token } });


      setTimeout(async () => {
        document.querySelectorAll('.skeleton-loader').forEach(el => el.classList.add('fade-out'));

        if (res.ok) {
          const data = await res.json();


          document.getElementById('stat-total').innerText = data.total_cases;
          document.getElementById('stat-pending').innerText = data.pending_hearings;
          document.getElementById('stat-today').innerText = data.todays_cases || '12';
          document.getElementById('stat-closed').innerText = data.closed_30_days || '85%';


          const urgentList = document.getElementById('urgent-list');
          if (data.urgent_cases && data.urgent_cases.length > 0) {
            urgentList.innerHTML = data.urgent_cases.map(c => `
                            <div class="flex items-center justify-between p-3 rounded-xl bg-gray-50 dark:bg-white/5 cursor-pointer hover:bg-gray-100 dark:hover:bg-white/10 transition-colors group">
                                <div>
                                    <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">${c.caseNumber}</div>
                                    <div class="text-[10px] text-gray-500 uppercase">${c.caseType}</div>
                                </div>
                                <span class="iconify text-gray-400 group-hover:text-indigo-500 transition-colors" data-icon="lucide:chevron-right"></span>
                            </div>
                        `).join('');
          } else {
            urgentList.innerHTML = '<div class="text-sm text-gray-500 italic p-2">No high priority cases.</div>';
          }


          const judgesList = document.getElementById('judges-list');
          if (data.active_judges && data.active_judges.length > 0) {
            judgesList.innerHTML = data.active_judges.map(j => `
                            <div class="flex items-center justify-between p-3 rounded-xl bg-gray-50 dark:bg-white/5 group">
                                <div class="flex items-center gap-3">
                                  <div class="w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center font-bold text-xs">
                                     ${j.name.charAt(7) || 'J'}
                                  </div>
                                  <div>
                                    <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">${j.name}</div>
                                    <div class="text-[10px] text-gray-500 uppercase flex items-center gap-1">
                                      <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span> Available
                                    </div>
                                  </div>
                                </div>
                            </div>
                        `).join('');
          } else {
            judgesList.innerHTML = '<div class="text-sm text-gray-500 italic p-2">No active judges found.</div>';
          }

        }
      }, 800);

    } catch (err) { console.error(err); }
  }


  fetchStats();


  function loadChart() {
    const ctx = document.getElementById('efficiencyChart')?.getContext('2d');
    if (!ctx) return;

    const isDark = document.documentElement.classList.contains('dark');


    const data = {
      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
      datasets: [
        {
          label: 'Cases Filed',
          data: [45, 52, 38, 65, 48, 55],
          backgroundColor: '#818CF8',
          borderRadius: 6,
          barThickness: 12
        },
        {
          label: 'Cases Disposed',
          data: [35, 45, 50, 60, 55, 62],
          backgroundColor: '#4338CA',
          borderRadius: 6,
          barThickness: 12
        }
      ]
    };

    new Chart(ctx, {
      type: 'bar',
      data: data,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'bottom', labels: { usePointStyle: true, color: isDark ? '#9CA3AF' : '#4B5563' } }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: { color: isDark ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)' },
            ticks: { color: isDark ? '#9CA3AF' : '#4B5563' }
          },
          x: {
            grid: { display: false },
            ticks: { color: isDark ? '#9CA3AF' : '#4B5563' }
          }
        }
      }
    });
  }


  setTimeout(loadChart, 300);


  document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('mainContent').classList.remove('opacity-0');
  });

</script>
{% endblock %}